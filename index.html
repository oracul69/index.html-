<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>vortoX • Two-Card Multiplier</title>
<style>
  :root{
    --bg:#0b0b0b; --text:#f5f5f5; --muted:#9aa0a6;
    --accent:#25c05a; --accent-dark:#1ea14a;
    --red:#e53935; --blue:#1e88e5; --trap:#ff3b30;
    --gold:#f7c948;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:var(--bg);color:var(--text);
            font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
  .wrap{max-width:820px;margin:0 auto;padding:16px 14px}

  /* top brand */
  .brand{display:flex;justify-content:center;align-items:center;margin:6px 0 10px}
  .brand .word{font-size:28px;font-weight:900;letter-spacing:.3px}
  .brand .word .x{color:var(--accent)}
  .badge{margin-left:8px;font-size:11px;color:#9ad896;border:1px solid #2a3; padding:2px 8px;border-radius:999px}

  h2,h3{margin:0 0 10px}
  .panel{background:#121212;border:1px solid #222;border-radius:14px;padding:14px;margin-bottom:12px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

  .stat{background:#0f0f0f;border:1px solid #242424;border-radius:12px;padding:8px 10px;min-width:120px}
  .stat .k{display:block;color:#b9b9b9;font-size:12px}
  .stat .v{display:block;font-weight:800;font-size:18px;margin-top:1px}

  .btn{cursor:pointer;border:0;border-radius:12px;padding:10px 14px;font-size:16px;font-weight:700;
       transition:transform .04s ease,opacity .2s ease}
  .btn:active{transform:translateY(1px)}
  .btn-ghost{background:#1e1e1e;border:1px solid #333;color:#ddd}
  .btn-primary{background:var(--accent);color:#07190e}
  .btn-disabled{opacity:.5;pointer-events:none}

  /* HUD */
  .topbar{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
  .icon-btn{background:#1b1b1b;border:1px solid #333;border-radius:12px;padding:10px;display:flex;align-items:center;justify-content:center}
  .icon-btn svg{width:22px;height:22px;display:block;stroke:#fff;stroke-width:2;fill:none;opacity:.95}

  /* arena */
  .arena{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin:12px 0 6px}
  .card{
    --edge:#2a2a2a;
    position:relative;isolation:isolate;border-radius:16px;aspect-ratio:3/5;
    display:flex;align-items:center;justify-content:center;
    background:#0e0e0e;border:2px dashed var(--edge);
    cursor:pointer;user-select:none;
    transform:scale(.60); transition:transform .28s ease,box-shadow .15s ease,border-color .2s ease,background .2s ease;
    perspective:1000px;
  }
  .card.revealed{border-style:solid}
  .card.red{--edge:var(--red)}
  .card.blue{--edge:var(--blue)}
  .card.bonus{--edge:var(--gold); background:
      radial-gradient(120% 120% at 100% 0%, rgba(255,255,255,.08), transparent 40%),
      linear-gradient(180deg, rgba(255,220,120,.20), rgba(255,204,72,.10));
    box-shadow:0 0 0 2px rgba(255,215,0,.25), 0 10px 28px rgba(0,0,0,.45);
  }
  @keyframes wiggle { 0%{transform:scale(.58)} 50%{transform:scale(.62)} 100%{transform:scale(.58)} }
  .card.wiggle{animation:wiggle 1.4s ease-in-out infinite}
  .card.picked{animation:none; transform:scale(1)}
  .card.shrunk{animation:none !important; transform:scale(.60)!important}

  /* flip system: separate faces so text doesn't flip */
  .faces{position:absolute;inset:0;border-radius:16px;transform-style:preserve-3d;
         transition:transform .5s ease}
  .card.flip .faces{transform:rotateY(180deg)}
  .face{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;border-radius:16px;
        backface-visibility:hidden}
  .front{ /* cover while hidden */
     background: radial-gradient(120% 120% at 100% 0%, rgba(255,255,255,.04), transparent 40%),
                 linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,0));
     border:2px solid var(--edge); font-weight:800;font-size:18px;letter-spacing:.06em
  }
  .back{ transform:rotateY(180deg); }
  .mult{font-size:44px;font-weight:900;color:#fff}
  .label{position:absolute;bottom:8px;left:12px;right:12px;text-align:center;font-size:13px;color:#ddd;opacity:.85}

  .success{border-color:var(--accent)!important;background:linear-gradient(180deg, rgba(37,192,90,.32), rgba(37,192,90,.18))}
  .trap{border-color:var(--trap)!important;background:linear-gradient(180deg, rgba(255,59,48,.32), rgba(255,59,48,.18))}

  .timerbar{height:12px;background:#1a1a1a;border:1px solid #333;border-radius:999px;overflow:hidden;margin-top:6px}
  .timerfill{height:100%;width:100%;background:linear-gradient(90deg,#4caf50,#8bc34a);transform-origin:left;transform:scaleX(1)}

  /* cash-buttons replaced by BET widget when spectating/lobby */
  .buttons{margin-top:10px}
  .btn-cash{background:var(--accent);color:#07190e;width:100%;padding:22px 18px;border-radius:18px;display:flex;flex-direction:column;align-items:center;gap:2px}
  .btn-cash .amount{font-size:18px;font-weight:900;opacity:.95}
  .btn-cash .label{font-size:24px;font-weight:900;letter-spacing:.5px}
  .btn-half{margin-top:10px;background:var(--accent-dark);color:#07190e;width:100%;padding:18px 18px;border-radius:16px;display:flex;flex-direction:column;align-items:center;gap:2px}
  .btn-half .amount{font-size:16px;font-weight:900;opacity:.95}
  .btn-half .label{font-size:18px;font-weight:900;letter-spacing:.4px}

  .under-controls{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:10px;flex-wrap:wrap}
  .round-pill{background:#0f0f0f;border:1px solid #242424;border-radius:999px;padding:8px 12px;font-weight:800}
  .footer{opacity:.7;font-size:12px;margin-top:10px;text-align:center}

  /* BET widget */
  .betbar{display:grid;grid-template-columns:1fr 1fr;gap:10px;align-items:center;margin-top:10px}
  .bet-left{display:grid;grid-template-columns:40px 1fr 40px;gap:8px}
  .spinner{background:#1b1b1b;border:1px solid #333;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:900}
  .spinner.btn{padding:10px}
  .amountBox{background:#0f0f0f;border:1px solid #333;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:900}
  .amountBox span{font-size:18px}
  .quick{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:8px}
  .quick .q{background:#1b1b1b;border:1px solid #333;border-radius:12px;padding:10px;text-align:center;font-weight:800}
  .bet-btn{background:var(--accent);color:#07190e;border-radius:14px;padding:18px 16px;font-weight:900;font-size:20px}
  .hint{color:var(--muted);font-size:12px;margin-top:6px}

  /* lobby overlay */
  .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;pointer-events:none}
  .overlay .pill{background:#000a;border:1px solid #333;color:#fff;padding:10px 14px;border-radius:999px;font-weight:900}

  .spectate .card{opacity:.5;pointer-events:none}
</style>
</head>
<body>
<div class="wrap">

  <!-- Brand -->
  <div class="brand">
    <div class="word">vorto<span class="x">X</span></div>
    <span class="badge">v26</span>
  </div>

  <!-- ===== Setup ===== -->
  <div class="panel" id="setupPanel">
    <div class="row" style="align-items:flex-end">
      <div class="stat"><span class="k">Wallet</span><span class="v" id="walletV">—</span></div>
      <button class="btn btn-ghost" id="apSetupBtn">Auto Play Setup</button>
      <button class="btn btn-primary" id="startBtn">Enter Arena</button>
    </div>
    <p class="hint">Global cycle: <b>5s Lobby</b> → <b>6-round Match</b> → <b>5s Lobby</b> → …  
      Place your bet in the lobby to join the next match. If you miss it, you spectate and can pre-bet for the next match.</p>
  </div>

  <!-- ===== Game ===== -->
  <div class="panel" id="gamePanel" style="display:none">
    <div class="topbar">
      <div class="stat" style="margin:0"><span class="k">Wallet</span><span class="v" id="walletV2">—</span></div>
      <button id="muteBtn" class="icon-btn" title="Toggle sound" aria-label="Toggle sound">
        <svg viewBox="0 0 24 24">
          <path id="spkr-body" d="M11 5 L6 9 H3 v6 h3 l5 4 z"></path>
          <path id="spkr-wave1" d="M14 9 q3 3 0 6"></path>
          <path id="spkr-wave2" d="M16 7 q6 5 0 10"></path>
          <path id="spkr-x1" style="opacity:0" d="M17 7 L21 11"></path>
          <path id="spkr-x2" style="opacity:0" d="M21 7 L17 11"></path>
        </svg>
      </button>
    </div>

    <div class="arena" id="arena">
      <!-- Left card -->
      <div class="card red wiggle" data-side="left">
        <div class="faces">
          <div class="front">TAP TO REVEAL</div>
          <div class="back"><div class="mult"></div></div>
        </div>
        <div class="label">Red Card</div>
      </div>
      <!-- Right card -->
      <div class="card blue wiggle" data-side="right">
        <div class="faces">
          <div class="front">TAP TO REVEAL</div>
          <div class="back"><div class="mult"></div></div>
        </div>
        <div class="label">Blue Card</div>
      </div>
    </div>

    <div class="timerbar"><div class="timerfill" id="timerFill"></div></div>

    <!-- When playing: cash-out buttons -->
    <div class="buttons" id="cashButtons" style="display:none">
      <button id="cashOutBtn" class="btn-cash">
        <div class="amount" id="cashAmt">0.00 GEL</div>
        <div class="label">CASH OUT</div>
      </button>
      <button id="cashHalfBtn" class="btn-half">
        <div class="amount" id="cashHalfAmt">0.00 GEL</div>
        <div class="label">CASH OUT 50%</div>
      </button>
    </div>

    <!-- When spectating/lobby: BET widget -->
    <div class="betbar" id="betBar" style="display:none">
      <div>
        <div class="bet-left">
          <button class="btn spinner" id="minusBtn">−</button>
          <div class="amountBox"><span id="betAmt">1.00</span>&nbsp;GEL</div>
          <button class="btn spinner" id="plusBtn">+</button>
        </div>
        <div class="quick">
          <div class="q" data-q="1">1</div>
          <div class="q" data-q="2">2</div>
          <div class="q" data-q="5">5</div>
          <div class="q" data-q="10">10</div>
        </div>
      </div>
      <div>
        <button class="bet-btn" id="betBtn">Bet <span id="betBtnAmt">1.00</span> GEL</button>
        <div class="hint" id="betHint">Join window opens in lobby or queue for the next match.</div>
      </div>
    </div>

    <div class="under-controls">
      <div class="round-pill" id="roundPill">Waiting…</div>
      <button id="autoToggleBtn"
